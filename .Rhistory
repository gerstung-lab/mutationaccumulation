Cutpoint=slider(0, 3, step=.5,
label='Cut point (optimal=mean x=0)'),
nsim=slider(300,2000, step=100, initial=500,
label='No. of simulations'))
getRs('demoSpline.r')
# title: Interactive Demo of Spline Fitting
# major: regression modeling
# minor: curve fitting
require(rms)
install.packages('rms')
setwd('~/Mutation accumulation/mutationaccumulation/')
library(ggplot2)
library(reshape2)
library(rtracklayer)
library(BSgenome)
worm_ref_genome <- "BSgenome.Celegans.UCSC.ce11"
library(worm_ref_genome, character.only = TRUE)
source('useful_functions.R')
library(vioplot)
library(RColorBrewer)
data <- read.csv('~/Desktop/worms_and_what_they_are_extended_2019.csv')
data$Sample <- as.character(data$Sample)
data$Genotype.new <- as.character(data$Genotype.new)
data$Code <- as.character(data$Code)
CD2Mutant <- sapply(data$Code, function(x) {
t <- unlist(strsplit(x,split="[:]"))
t[t=="NA"] <- ""
if (t[4]!="") # mutagen exposure
return(paste(t[3],substr(t[4],1,3),t[5],t[7],sep=":")) # genotype, mutagen, dose, experiment type, generation
if (t[4]=="") # mutation accumulation
return(paste(t[3],t[7],sep=":")) # genotype, experiment type, generation
})
names(CD2Mutant) <- data$Sample
CD2Mutant[grep('xpg.1',CD2Mutant)]
Y <- read.csv('~/Spectrum_119_most_recent.csv')
rowSums(Y[names(CD2Mutant)[grep('xpg',CD2Mutant)]])
rowSums(Y[names(CD2Mutant)[grep('xpg',CD2Mutant)],])
Y[names(CD2Mutant)[grep('xpg',CD2Mutant)],]
head(Y)
Y <- read.csv('~/Spectrum_119_most_recent.csv', row.names = )
Y <- read.csv('~/Spectrum_119_most_recent.csv', row.names = 1)
head(Y)
Y[names(CD2Mutant)[grep('xpg',CD2Mutant)],]
rowSums(Y[names(CD2Mutant)[grep('xpg',CD2Mutant)],])
short.Y <- cbind(rowSums(Y[,1:16]),rowSums(Y[,17:32]),rowSums(Y[,33:48]),rowSums(Y[,49:64]),
rowSums(Y[,65:80]),rowSums(Y[,81:96]), rowSums(Y[,97:98]), rowSums(Y[,99:104]),
rowSums(Y[,105:106]), rowSums(Y[,107:112]),rowSums(Y[,113:119]))
CD2Mutant[grep('xpf',CD2Mutant)]
head(data)
CD2Mutant[grepl('xpf',CD2Mutant) & data$Type == 'mut.acc.']
CD2Mutant[grepl('xpa',CD2Mutant) & data$Type == 'mut.acc.']
rowSums(Y[names(CD2Mutant)[CD2Mutant == 'xpf-1:0']])
rowSums(Y[names(CD2Mutant)[CD2Mutant == 'xpf-1:0'],])
rowSums(Y[names(CD2Mutant)[CD2Mutant == 'xpf-1:20'],])
rowSums(Y[names(CD2Mutant)[CD2Mutant == 'xpf-1:40'],])
CD2Mutant[grepl('xpc',CD2Mutant) & data$Type == 'mut.acc.']
CD2Mutant[grepl('xpg',CD2Mutant) & data$Type == 'mut.acc.']
CD2Mutant[grepl('csb',CD2Mutant) & data$Type == 'mut.acc.']
f <- barplot(t(rbind(short.Y[names(CD2Mutant)[CD2Mutant== 'N2:0'],,drop = F],
short.Y[names(CD2Mutant)[CD2Mutant== 'N2:20'],],
short.Y[names(CD2Mutant)[CD2Mutant== 'N2:40'],],
rep(0,11),
rep(0,11),
short.Y[names(CD2Mutant)[CD2Mutant== 'agt-2:0'],,drop = F],
short.Y[names(CD2Mutant)[CD2Mutant== 'agt-2:20'],],
rep(0,11),
rep(0,11),
short.Y[names(CD2Mutant)[CD2Mutant== 'ung-1:0'],,drop = F],
short.Y[names(CD2Mutant)[CD2Mutant== 'ung-1:20'],],
short.Y[names(CD2Mutant)[CD2Mutant== 'ung-1:40'],],
rep(0,11),
rep(0,11),
short.Y[names(CD2Mutant)[CD2Mutant== 'xpa-1:0'],,drop = F],
short.Y[names(CD2Mutant)[CD2Mutant== 'xpa-1:20'],],
short.Y[names(CD2Mutant)[CD2Mutant== 'xpa-1:40'],],
rep(0,11),
rep(0,11),
short.Y[names(CD2Mutant)[CD2Mutant== 'xpf-1:0'],,drop = F],
short.Y[names(CD2Mutant)[CD2Mutant== 'xpf-1:20'],],
short.Y[names(CD2Mutant)[CD2Mutant== 'xpf-1:40'],],
rep(0,11),
rep(0,11),
short.Y[names(CD2Mutant)[CD2Mutant== 'xpg-1:1'],,drop = F],
short.Y[names(CD2Mutant)[CD2Mutant== 'xpg-1:20'],],
rep(0,11),
rep(0,11),
short.Y[names(CD2Mutant)[CD2Mutant== 'xpc-1:0'],,drop = F],
short.Y[names(CD2Mutant)[CD2Mutant== 'xpc-1:20'],],
rep(0,11),
rep(0,11),
short.Y[names(CD2Mutant)[CD2Mutant== 'csb-1:0'],,drop = F],
short.Y[names(CD2Mutant)[CD2Mutant== 'csb-1:20'],])),
col = c("#2EBAED","#000000","#DE1C14","#D4D2D2","#ADCC54","#F0D0CE",
"brown","#8DD3C7","#FFFFB3","#BEBADA","darkmagenta"),
xaxt = 'n', las = 2, border = NA, ylim = c(-2,50))
short.Y[names(CD2Mutant)[CD2Mutant== 'N2:0'],,drop = F],
short.Y[names(CD2Mutant)[CD2Mutant== 'N2:20'],],
short.Y[names(CD2Mutant)[CD2Mutant== 'N2:40'],]
short.Y[names(CD2Mutant)[CD2Mutant== 'agt-2:0'],,drop = F],
short.Y[names(CD2Mutant)[CD2Mutant== 'agt-2:20'],]
short.Y[names(CD2Mutant)[CD2Mutant== 'ung-1:0'],,drop = F],
short.Y[names(CD2Mutant)[CD2Mutant== 'ung-1:20'],],
short.Y[names(CD2Mutant)[CD2Mutant== 'ung-1:40'],],
rbind(short.Y[names(CD2Mutant)[CD2Mutant== 'N2:0'],,drop = F],
short.Y[names(CD2Mutant)[CD2Mutant== 'N2:20'],],
short.Y[names(CD2Mutant)[CD2Mutant== 'N2:40'],],
rep(0,11),
rep(0,11),
short.Y[names(CD2Mutant)[CD2Mutant== 'agt-2:0'],,drop = F],
short.Y[names(CD2Mutant)[CD2Mutant== 'agt-2:20'],],
rep(0,11),
rep(0,11),
short.Y[names(CD2Mutant)[CD2Mutant== 'ung-1:0'],,drop = F],
short.Y[names(CD2Mutant)[CD2Mutant== 'ung-1:20'],],
short.Y[names(CD2Mutant)[CD2Mutant== 'ung-1:40'],],
rep(0,11),
rep(0,11),
short.Y[names(CD2Mutant)[CD2Mutant== 'xpa-1:0'],,drop = F],
short.Y[names(CD2Mutant)[CD2Mutant== 'xpa-1:20'],],
short.Y[names(CD2Mutant)[CD2Mutant== 'xpa-1:40'],],
rep(0,11),
rep(0,11),
short.Y[names(CD2Mutant)[CD2Mutant== 'xpf-1:0'],,drop = F],
short.Y[names(CD2Mutant)[CD2Mutant== 'xpf-1:20'],],
short.Y[names(CD2Mutant)[CD2Mutant== 'xpf-1:40'],],
rep(0,11),
rep(0,11),
short.Y[names(CD2Mutant)[CD2Mutant== 'xpg-1:1'],,drop = F],
short.Y[names(CD2Mutant)[CD2Mutant== 'xpg-1:20'],],
rep(0,11),
rep(0,11),
short.Y[names(CD2Mutant)[CD2Mutant== 'xpc-1:0'],,drop = F],
short.Y[names(CD2Mutant)[CD2Mutant== 'xpc-1:20'],],
rep(0,11),
rep(0,11),
short.Y[names(CD2Mutant)[CD2Mutant== 'csb-1:0'],,drop = F],
short.Y[names(CD2Mutant)[CD2Mutant== 'csb-1:20'],])
rbind(short.Y[names(CD2Mutant)[CD2Mutant== 'N2:0'],,drop = F],
short.Y[names(CD2Mutant)[CD2Mutant== 'N2:20'],],
short.Y[names(CD2Mutant)[CD2Mutant== 'N2:40'],],
rep(0,11),
rep(0,11),
short.Y[names(CD2Mutant)[CD2Mutant== 'agt-2:0'],,drop = F],
short.Y[names(CD2Mutant)[CD2Mutant== 'agt-2:20'],],
rep(0,11),
rep(0,11),
short.Y[names(CD2Mutant)[CD2Mutant== 'ung-1:0'],,drop = F],
short.Y[names(CD2Mutant)[CD2Mutant== 'ung-1:20'],],
short.Y[names(CD2Mutant)[CD2Mutant== 'ung-1:40'],])
rbind(short.Y[names(CD2Mutant)[CD2Mutant== 'N2:0'],,drop = F],
short.Y[names(CD2Mutant)[CD2Mutant== 'N2:20'],],
short.Y[names(CD2Mutant)[CD2Mutant== 'N2:40'],])
CD2Mutant <- CD2Mutant[rownames(short.Y)]
f <- barplot(t(rbind(short.Y[names(CD2Mutant)[CD2Mutant== 'N2:0'],,drop = F],
short.Y[names(CD2Mutant)[CD2Mutant== 'N2:20'],],
short.Y[names(CD2Mutant)[CD2Mutant== 'N2:40'],],
rep(0,11),
rep(0,11),
short.Y[names(CD2Mutant)[CD2Mutant== 'agt-2:0'],,drop = F],
short.Y[names(CD2Mutant)[CD2Mutant== 'agt-2:20'],],
rep(0,11),
rep(0,11),
short.Y[names(CD2Mutant)[CD2Mutant== 'ung-1:0'],,drop = F],
short.Y[names(CD2Mutant)[CD2Mutant== 'ung-1:20'],],
short.Y[names(CD2Mutant)[CD2Mutant== 'ung-1:40'],],
rep(0,11),
rep(0,11),
short.Y[names(CD2Mutant)[CD2Mutant== 'xpa-1:0'],,drop = F],
short.Y[names(CD2Mutant)[CD2Mutant== 'xpa-1:20'],],
short.Y[names(CD2Mutant)[CD2Mutant== 'xpa-1:40'],],
rep(0,11),
rep(0,11),
short.Y[names(CD2Mutant)[CD2Mutant== 'xpf-1:0'],,drop = F],
short.Y[names(CD2Mutant)[CD2Mutant== 'xpf-1:20'],],
short.Y[names(CD2Mutant)[CD2Mutant== 'xpf-1:40'],],
rep(0,11),
rep(0,11),
short.Y[names(CD2Mutant)[CD2Mutant== 'xpg-1:1'],,drop = F],
short.Y[names(CD2Mutant)[CD2Mutant== 'xpg-1:20'],],
rep(0,11),
rep(0,11),
short.Y[names(CD2Mutant)[CD2Mutant== 'xpc-1:0'],,drop = F],
short.Y[names(CD2Mutant)[CD2Mutant== 'xpc-1:20'],],
rep(0,11),
rep(0,11),
short.Y[names(CD2Mutant)[CD2Mutant== 'csb-1:0'],,drop = F],
short.Y[names(CD2Mutant)[CD2Mutant== 'csb-1:20'],])),
col = c("#2EBAED","#000000","#DE1C14","#D4D2D2","#ADCC54","#F0D0CE",
"brown","#8DD3C7","#FFFFB3","#BEBADA","darkmagenta"),
xaxt = 'n', las = 2, border = NA, ylim = c(-2,50))
lines(x = rep(f[4] + (f[5]-f[4])/2,2), y = c(-2,30))
lines(x = rep(f[23] + (f[24]-f[23])/2,2), y = c(-2,40))
lines(x = rep(f[31] + (f[32]-f[31])/2,2), y = c(-2,40))
lines(x = rep(f[44] + (f[45]-f[44])/2,2), y = c(-2,40))
lines(x = rep(f[47] + (f[48]-f[47])/2,2), y = c(-2,40))
legend('topleft', fill = c("#2EBAED","#000000","#DE1C14","#D4D2D2","#ADCC54","#F0D0CE",
"brown","#8DD3C7","#FFFFB3","#BEBADA","darkmagenta"),ncol = 2,
legend = c('C>A','C>G','C>T','T>A','T>C','T>G','MNV',
'Del', 'Del/Ins', 'Ins', 'SV'), border = NA, bty = 'n', cex = 0.8)
lines(x = rep(f[54] + (f[55]-f[54])/2,2), y = c(-2,40))
lines(x = rep(f[57] + (f[48]-f[47])/2,2), y = c(-2,40))
lines(x = rep(f[64] + (f[65]-f[64])/2,2), y = c(-2,40))
lines(x = rep(f[67] + (f[68]-f[67])/2,2), y = c(-2,40))
lines(x = rep(f[75] + (f[76]-f[75])/2,2), y = c(-2,40))
lines(x = rep(f[84] + (f[85]-f[84])/2,2), y = c(-2,40))
lines(x = rep(f[96] + (f[97]-f[96])/2,2), y = c(-2,40))
pdf('~/Desktop/NER_barplots.pdf',6,5)
f <- barplot(t(rbind(short.Y[names(CD2Mutant)[CD2Mutant== 'N2:0'],,drop = F],
short.Y[names(CD2Mutant)[CD2Mutant== 'N2:20'],],
short.Y[names(CD2Mutant)[CD2Mutant== 'N2:40'],],
rep(0,11),
rep(0,11),
short.Y[names(CD2Mutant)[CD2Mutant== 'agt-2:0'],,drop = F],
short.Y[names(CD2Mutant)[CD2Mutant== 'agt-2:20'],],
rep(0,11),
rep(0,11),
short.Y[names(CD2Mutant)[CD2Mutant== 'ung-1:0'],,drop = F],
short.Y[names(CD2Mutant)[CD2Mutant== 'ung-1:20'],],
short.Y[names(CD2Mutant)[CD2Mutant== 'ung-1:40'],],
rep(0,11),
rep(0,11),
short.Y[names(CD2Mutant)[CD2Mutant== 'xpa-1:0'],,drop = F],
short.Y[names(CD2Mutant)[CD2Mutant== 'xpa-1:20'],],
short.Y[names(CD2Mutant)[CD2Mutant== 'xpa-1:40'],],
rep(0,11),
rep(0,11),
short.Y[names(CD2Mutant)[CD2Mutant== 'xpf-1:0'],,drop = F],
short.Y[names(CD2Mutant)[CD2Mutant== 'xpf-1:20'],],
short.Y[names(CD2Mutant)[CD2Mutant== 'xpf-1:40'],],
rep(0,11),
rep(0,11),
short.Y[names(CD2Mutant)[CD2Mutant== 'xpg-1:1'],,drop = F],
short.Y[names(CD2Mutant)[CD2Mutant== 'xpg-1:20'],],
rep(0,11),
rep(0,11),
short.Y[names(CD2Mutant)[CD2Mutant== 'xpc-1:0'],,drop = F],
short.Y[names(CD2Mutant)[CD2Mutant== 'xpc-1:20'],],
rep(0,11),
rep(0,11),
short.Y[names(CD2Mutant)[CD2Mutant== 'csb-1:0'],,drop = F],
short.Y[names(CD2Mutant)[CD2Mutant== 'csb-1:20'],])),
col = c("#2EBAED","#000000","#DE1C14","#D4D2D2","#ADCC54","#F0D0CE",
"brown","#8DD3C7","#FFFFB3","#BEBADA","darkmagenta"),
xaxt = 'n', las = 2, border = NA, ylim = c(-2,50))
lines(x = rep(f[4] + (f[5]-f[4])/2,2), y = c(-2,30))
lines(x = rep(f[23] + (f[24]-f[23])/2,2), y = c(-2,40))
lines(x = rep(f[31] + (f[32]-f[31])/2,2), y = c(-2,40))
lines(x = rep(f[44] + (f[45]-f[44])/2,2), y = c(-2,40))
lines(x = rep(f[47] + (f[48]-f[47])/2,2), y = c(-2,40))
lines(x = rep(f[54] + (f[55]-f[54])/2,2), y = c(-2,40))
lines(x = rep(f[57] + (f[48]-f[47])/2,2), y = c(-2,40))
lines(x = rep(f[64] + (f[65]-f[64])/2,2), y = c(-2,40))
lines(x = rep(f[67] + (f[68]-f[67])/2,2), y = c(-2,40))
lines(x = rep(f[75] + (f[76]-f[75])/2,2), y = c(-2,40))
lines(x = rep(f[84] + (f[85]-f[84])/2,2), y = c(-2,40))
lines(x = rep(f[96] + (f[97]-f[96])/2,2), y = c(-2,40))
legend('topleft', fill = c("#2EBAED","#000000","#DE1C14","#D4D2D2","#ADCC54","#F0D0CE",
"brown","#8DD3C7","#FFFFB3","#BEBADA","darkmagenta"),ncol = 2,
legend = c('C>A','C>G','C>T','T>A','T>C','T>G','MNV',
'Del', 'Del/Ins', 'Ins', 'SV'), border = NA, bty = 'n', cex = 0.8)
dev.off()
pdf('~/Desktop/NER_barplots.pdf',10,6)
f <- barplot(t(rbind(short.Y[names(CD2Mutant)[CD2Mutant== 'N2:0'],,drop = F],
short.Y[names(CD2Mutant)[CD2Mutant== 'N2:20'],],
short.Y[names(CD2Mutant)[CD2Mutant== 'N2:40'],],
rep(0,11),
rep(0,11),
short.Y[names(CD2Mutant)[CD2Mutant== 'agt-2:0'],,drop = F],
short.Y[names(CD2Mutant)[CD2Mutant== 'agt-2:20'],],
rep(0,11),
rep(0,11),
short.Y[names(CD2Mutant)[CD2Mutant== 'ung-1:0'],,drop = F],
short.Y[names(CD2Mutant)[CD2Mutant== 'ung-1:20'],],
short.Y[names(CD2Mutant)[CD2Mutant== 'ung-1:40'],],
rep(0,11),
rep(0,11),
short.Y[names(CD2Mutant)[CD2Mutant== 'xpa-1:0'],,drop = F],
short.Y[names(CD2Mutant)[CD2Mutant== 'xpa-1:20'],],
short.Y[names(CD2Mutant)[CD2Mutant== 'xpa-1:40'],],
rep(0,11),
rep(0,11),
short.Y[names(CD2Mutant)[CD2Mutant== 'xpf-1:0'],,drop = F],
short.Y[names(CD2Mutant)[CD2Mutant== 'xpf-1:20'],],
short.Y[names(CD2Mutant)[CD2Mutant== 'xpf-1:40'],],
rep(0,11),
rep(0,11),
short.Y[names(CD2Mutant)[CD2Mutant== 'xpg-1:1'],,drop = F],
short.Y[names(CD2Mutant)[CD2Mutant== 'xpg-1:20'],],
rep(0,11),
rep(0,11),
short.Y[names(CD2Mutant)[CD2Mutant== 'xpc-1:0'],,drop = F],
short.Y[names(CD2Mutant)[CD2Mutant== 'xpc-1:20'],],
rep(0,11),
rep(0,11),
short.Y[names(CD2Mutant)[CD2Mutant== 'csb-1:0'],,drop = F],
short.Y[names(CD2Mutant)[CD2Mutant== 'csb-1:20'],])),
col = c("#2EBAED","#000000","#DE1C14","#D4D2D2","#ADCC54","#F0D0CE",
"brown","#8DD3C7","#FFFFB3","#BEBADA","darkmagenta"),
xaxt = 'n', las = 2, border = NA, ylim = c(-2,50))
lines(x = rep(f[4] + (f[5]-f[4])/2,2), y = c(-2,30))
lines(x = rep(f[23] + (f[24]-f[23])/2,2), y = c(-2,40))
lines(x = rep(f[31] + (f[32]-f[31])/2,2), y = c(-2,40))
lines(x = rep(f[44] + (f[45]-f[44])/2,2), y = c(-2,40))
lines(x = rep(f[47] + (f[48]-f[47])/2,2), y = c(-2,40))
lines(x = rep(f[54] + (f[55]-f[54])/2,2), y = c(-2,40))
lines(x = rep(f[57] + (f[48]-f[47])/2,2), y = c(-2,40))
lines(x = rep(f[64] + (f[65]-f[64])/2,2), y = c(-2,40))
lines(x = rep(f[67] + (f[68]-f[67])/2,2), y = c(-2,40))
lines(x = rep(f[75] + (f[76]-f[75])/2,2), y = c(-2,40))
lines(x = rep(f[84] + (f[85]-f[84])/2,2), y = c(-2,40))
lines(x = rep(f[96] + (f[97]-f[96])/2,2), y = c(-2,40))
legend('topleft', fill = c("#2EBAED","#000000","#DE1C14","#D4D2D2","#ADCC54","#F0D0CE",
"brown","#8DD3C7","#FFFFB3","#BEBADA","darkmagenta"),ncol = 2,
legend = c('C>A','C>G','C>T','T>A','T>C','T>G','MNV',
'Del', 'Del/Ins', 'Ins', 'SV'), border = NA, bty = 'n', cex = 0.8)
dev.off()
pdf('~/Desktop/NER_barplots.pdf',10,6)
f <- barplot(t(rbind(short.Y[names(CD2Mutant)[CD2Mutant== 'N2:0'],,drop = F],
short.Y[names(CD2Mutant)[CD2Mutant== 'N2:20'],],
short.Y[names(CD2Mutant)[CD2Mutant== 'N2:40'],],
rep(0,11),
rep(0,11),
short.Y[names(CD2Mutant)[CD2Mutant== 'agt-2:0'],,drop = F],
short.Y[names(CD2Mutant)[CD2Mutant== 'agt-2:20'],],
rep(0,11),
rep(0,11),
short.Y[names(CD2Mutant)[CD2Mutant== 'ung-1:0'],,drop = F],
short.Y[names(CD2Mutant)[CD2Mutant== 'ung-1:20'],],
short.Y[names(CD2Mutant)[CD2Mutant== 'ung-1:40'],],
rep(0,11),
rep(0,11),
short.Y[names(CD2Mutant)[CD2Mutant== 'xpa-1:0'],,drop = F],
short.Y[names(CD2Mutant)[CD2Mutant== 'xpa-1:20'],],
short.Y[names(CD2Mutant)[CD2Mutant== 'xpa-1:40'],],
rep(0,11),
rep(0,11),
short.Y[names(CD2Mutant)[CD2Mutant== 'xpf-1:0'],,drop = F],
short.Y[names(CD2Mutant)[CD2Mutant== 'xpf-1:20'],],
short.Y[names(CD2Mutant)[CD2Mutant== 'xpf-1:40'],],
rep(0,11),
rep(0,11),
short.Y[names(CD2Mutant)[CD2Mutant== 'xpg-1:1'],,drop = F],
short.Y[names(CD2Mutant)[CD2Mutant== 'xpg-1:20'],],
rep(0,11),
rep(0,11),
short.Y[names(CD2Mutant)[CD2Mutant== 'xpc-1:0'],,drop = F],
short.Y[names(CD2Mutant)[CD2Mutant== 'xpc-1:20'],],
rep(0,11),
rep(0,11),
short.Y[names(CD2Mutant)[CD2Mutant== 'csb-1:0'],,drop = F],
short.Y[names(CD2Mutant)[CD2Mutant== 'csb-1:20'],])),
col = c("#2EBAED","#000000","#DE1C14","#D4D2D2","#ADCC54","#F0D0CE",
"brown","#8DD3C7","#FFFFB3","#BEBADA","darkmagenta"),
xaxt = 'n', las = 2, border = NA, ylim = c(-2,50))
lines(x = rep(f[4] + (f[5]-f[4])/2,2), y = c(-2,30))
lines(x = rep(f[23] + (f[24]-f[23])/2,2), y = c(-2,40))
lines(x = rep(f[31] + (f[32]-f[31])/2,2), y = c(-2,40))
lines(x = rep(f[44] + (f[45]-f[44])/2,2), y = c(-2,40))
lines(x = rep(f[47] + (f[48]-f[47])/2,2), y = c(-2,40))
lines(x = rep(f[54] + (f[55]-f[54])/2,2), y = c(-2,40))
lines(x = rep(f[57] + (f[48]-f[47])/2,2), y = c(-2,40))
lines(x = rep(f[64] + (f[65]-f[64])/2,2), y = c(-2,40))
lines(x = rep(f[67] + (f[68]-f[67])/2,2), y = c(-2,40))
lines(x = rep(f[75] + (f[76]-f[75])/2,2), y = c(-2,40))
lines(x = rep(f[84] + (f[85]-f[84])/2,2), y = c(-2,40))
lines(x = rep(f[96] + (f[97]-f[96])/2,2), y = c(-2,40))
legend('topleft', fill = c("#2EBAED","#000000","#DE1C14","#D4D2D2","#ADCC54","#F0D0CE",
"brown","#8DD3C7","#FFFFB3","#BEBADA","darkmagenta"),ncol = 2,
legend = c('C>A','C>G','C>T','T>A','T>C','T>G','MNV',
'Del', 'Del/Ins', 'Ins', 'SV'), border = NA, bty = 'n')
dev.off()
pdf('~/Desktop/NER_barplots.pdf',10,6)
f <- barplot(t(rbind(short.Y[names(CD2Mutant)[CD2Mutant== 'N2:0'],,drop = F],
short.Y[names(CD2Mutant)[CD2Mutant== 'N2:20'],],
short.Y[names(CD2Mutant)[CD2Mutant== 'N2:40'],],
NA,
NA,
short.Y[names(CD2Mutant)[CD2Mutant== 'agt-2:0'],,drop = F],
short.Y[names(CD2Mutant)[CD2Mutant== 'agt-2:20'],],
NA,
NA,
short.Y[names(CD2Mutant)[CD2Mutant== 'ung-1:0'],,drop = F],
short.Y[names(CD2Mutant)[CD2Mutant== 'ung-1:20'],],
short.Y[names(CD2Mutant)[CD2Mutant== 'ung-1:40'],],
NA,
NA,
short.Y[names(CD2Mutant)[CD2Mutant== 'xpa-1:0'],,drop = F],
short.Y[names(CD2Mutant)[CD2Mutant== 'xpa-1:20'],],
short.Y[names(CD2Mutant)[CD2Mutant== 'xpa-1:40'],],
NA,
NA,
short.Y[names(CD2Mutant)[CD2Mutant== 'xpf-1:0'],,drop = F],
short.Y[names(CD2Mutant)[CD2Mutant== 'xpf-1:20'],],
short.Y[names(CD2Mutant)[CD2Mutant== 'xpf-1:40'],],
NA,
NA,
short.Y[names(CD2Mutant)[CD2Mutant== 'xpg-1:1'],,drop = F],
short.Y[names(CD2Mutant)[CD2Mutant== 'xpg-1:20'],],
NA,
NA,
short.Y[names(CD2Mutant)[CD2Mutant== 'xpc-1:0'],,drop = F],
short.Y[names(CD2Mutant)[CD2Mutant== 'xpc-1:20'],],
NA,
NA,
short.Y[names(CD2Mutant)[CD2Mutant== 'csb-1:0'],,drop = F],
short.Y[names(CD2Mutant)[CD2Mutant== 'csb-1:20'],])),
col = c("#2EBAED","#000000","#DE1C14","#D4D2D2","#ADCC54","#F0D0CE",
"brown","#8DD3C7","#FFFFB3","#BEBADA","darkmagenta"),
xaxt = 'n', las = 2, border = NA, ylim = c(-2,50))
lines(x = rep(f[4] + (f[5]-f[4])/2,2), y = c(-2,30))
lines(x = rep(f[23] + (f[24]-f[23])/2,2), y = c(-2,40))
lines(x = rep(f[31] + (f[32]-f[31])/2,2), y = c(-2,40))
lines(x = rep(f[44] + (f[45]-f[44])/2,2), y = c(-2,40))
lines(x = rep(f[47] + (f[48]-f[47])/2,2), y = c(-2,40))
lines(x = rep(f[54] + (f[55]-f[54])/2,2), y = c(-2,40))
lines(x = rep(f[57] + (f[48]-f[47])/2,2), y = c(-2,40))
lines(x = rep(f[64] + (f[65]-f[64])/2,2), y = c(-2,40))
lines(x = rep(f[67] + (f[68]-f[67])/2,2), y = c(-2,40))
lines(x = rep(f[75] + (f[76]-f[75])/2,2), y = c(-2,40))
lines(x = rep(f[84] + (f[85]-f[84])/2,2), y = c(-2,40))
lines(x = rep(f[96] + (f[97]-f[96])/2,2), y = c(-2,40))
legend('topleft', fill = c("#2EBAED","#000000","#DE1C14","#D4D2D2","#ADCC54","#F0D0CE",
"brown","#8DD3C7","#FFFFB3","#BEBADA","darkmagenta"),ncol = 2,
legend = c('C>A','C>G','C>T','T>A','T>C','T>G','MNV',
'Del', 'Del/Ins', 'Ins', 'SV'), border = NA, bty = 'n')
dev.off()
CD2Mutant[grep('brc-1:Rad')]
CD2Mutant[grep('brc-1:Rad',CD2Mutant)]
rowSums(Y[names(CD2Mutant)[grep('brc-1:Rad',CD2Mutant)],])
summary(rowSums(Y[names(CD2Mutant)[grep('brc-1:Rad',CD2Mutant)],]))
summary(rowSums(Y[names(CD2Mutant)[grep('brc-1:40',CD2Mutant)],]))
summary(rowSums(Y[names(CD2Mutant)[grep('brc-1:40',CD2Mutant)],1:96]))
summary(rowSums(Y[names(CD2Mutant)[grep('brc-1:Rad',CD2Mutant)],1:96]))
summary(rowSums(Y[names(CD2Mutant)[grep('brc-1:Rad:80',CD2Mutant)],1:96]))
summary(rowSums(Y[names(CD2Mutant)[grep('brc-1:40',CD2Mutant)],1:96]))
summary(rowSums(Y[names(CD2Mutant)[grep('N2:0',CD2Mutant)],99:112]))
summary(rowSums(Y[names(CD2Mutant)[grep('N2:1',CD2Mutant)],99:112]))
summary(rowSums(Y[names(CD2Mutant)[grep('N2:10',CD2Mutant)],99:112]))
summary(rowSums(Y[names(CD2Mutant)[grep('N2:20',CD2Mutant)],99:112]))
# Libraries
library(greta)
library(bayesplot)
library(MASS)
library(VariantAnnotation)
library(ggplot2)
library(reshape2)
library(ggpubr)
setwd('~/Mutation accumulation/mutationaccumulation/')
# Libraries
library(greta)
library(bayesplot)
library(MASS)
library(VariantAnnotation)
library(ggplot2)
library(reshape2)
library(ggpubr)
source('plotting_functions.R')
source('useful_functions.R')
sessionInfo()
library(ggpubr)
sessionInfo()
GG_save_pdf
source('~/Mutation accumulation/mutationaccumulation/useful_functions.R')
GG_save_pdf
Y <- read.csv('~/Spectrum_119_most_recent.csv')
data <- read.csv('~/Desktop/worms_and_what_they_are_extended_2019.csv')
ata$Sample <- as.character(data$Sample)
data$Genotype.new <- as.character(data$Genotype.new)
data$Code <- as.character(data$Code)
CD2Mutant <- sapply(data$Code, function(x) {
t <- unlist(strsplit(x,split="[:]"))
t[t=="NA"] <- ""
return(paste(t[3],t[7],sep=":")) # genotype, experiment type, generation
}) # short notations
names(CD2Mutant) <- data$Sample
data$Sample <- as.character(data$Sample)
names(CD2Mutant) <- data$Sample
Y <- read.csv('~/Spectrum_119_most_recent.csv', row.names = 1)
CD2Mutant[rownames(Y)]
CD2Mutant[rownames(Y)] -> CD2Mutant
rowSums(Y[CD2Mutant == 'N2:1',c(99,107)])
summary(rowSums(Y[CD2Mutant == 'N2:1',c(99,107)]))
summary(rowSums(Y[CD2Mutant == 'N2:10',c(99,107)]))
summary(rowSums(Y[CD2Mutant == 'N2:20',c(99,107)]))
summary(rowSums(Y[CD2Mutant == 'N2:1',c(99,107)]))
summary(rowSums(Y[CD2Mutant == 'N2:1',c(99:112)]))
summary(rowSums(Y[CD2Mutant == 'N2:1',]))
summary(rowSums(Y[CD2Mutant == 'N2:10',]))
colnames(Y)
summary(rowSums(Y[CD2Mutant == 'N2:10',c(99,107)]) / rowSums(Y[CD2Mutant == 'N2:10',]))
summary(rowSums(Y[CD2Mutant == 'N2:10',c(99,107)]))
summary(rowSums(Y[CD2Mutant == 'N2:0',c(99,107)]))
summary(rowSums(Y[CD2Mutant == 'N2:20',c(99,107)]))
0.26 _ 0.58
0.26 + 0.58
0.26 / (0.58 + 0.02 + 0.58)
0.26 / (0.58 + 0.02 + 0.26)
800/1100
0.861656314683115 / 15
0.861656314683115 / 15 / 100272607
0.861656314683115 / 15 / 100272607 / 2
1 / 15 / 100272607
1 / 15 / 100272607 / 2
0.763661976131524 / 15 / 100272607 / 2
0.957823995468134 / 15 / 100272607 / 2
0.957823995468134 / 15 / 100272607
100272607 * 15 * 1
100272607 * 15 * 1 / 1000000000
109/0.26
620 / 5
650 / 5
110 * 0.9
